var IV={_isOn:!1};IV.on=function(){if(!IV._isOn){IV._isOn=!0;var n=function(){var n=$(this),t,r,i,u;return n.attr("iv")?(n.children().css("color","black"),n.removeAttr("iv"),n.next().find(".pv-facet-facetitem").show(),n.next().find(".pv-facet-iv").remove(),n.next().find(".pv-facet-facetitem-label").css("color","black"),t=n.next().find(".pv-filterpanel-numericslider"),t.slider("values",[t.slider("option","min"),t.slider("option","max")]),t.parent().find(".pv-filterpanel-numericslider-range-val").text(t.slider("option","min")+" - "+t.slider("option","max")),$.publish("/PivotViewer/Views/IVFiltered"),!1):n.next().find(".pv-facet-facetitem:checked").length!=0?!1:(n.attr("iv",!0),n.children().css("color","blue"),r=PivotCollection.getCategoryByName(PV._nameMapping[n.attr("facet")]),r.uiInit||PV.initUIFacet(r),i=n.next().find(".pv-facet-facetitem"),u=i.next(),i.next().css("color","blue"),i.each(function(){$(this).after("<input type='checkbox' class='pv-facet-iv' itemvalue='"+$(this).attr("itemvalue")+"'>");$(this).next().click(function(){facetItemClick(this)})}),i.hide(),$.publish("/PivotViewer/Views/IVFiltered"),!1)};IV.facetItemClick=PV.facetItemClick;PV.facetItemClick=function(n){$(n).parent().parent().parent().prev().attr("iv")?$.publish("/PivotViewer/Views/IVFiltered"):IV.facetItemClick(n)};IV.sliderStop=PV.sliderStop;PV.sliderStop=function(n,t,i,r){n.parent().parent().prev().attr("iv")?$.publish("/PivotViewer/Views/IVFiltered"):IV.sliderStop(n,t,i,r)};$(".pv-facet").on("contextmenu",n)}};IV.off=function(){if(IV._isOn){IV._isOn=!1;var n=$(".pv-facet[iv=true]");n.children().css("color","black");n.next().find(".pv-facet-facetitem-label").css("color","black");$(".pv-facet").off("contextmenu");n.next().find(".pv-facet-facetitem").show();n.next().find(".pv-facet-iv").remove();n.next().find(".pv-filterpanel-numericslider").each(function(){var n=$(this);n.parent().find(".pv-filterpanel-numericslider-range-val").text(n.slider("option","min")+" - "+n.slider("option","max"));n.slider("values",[n.slider("option","min"),n.slider("option","max")])});n.removeAttr("iv");PV.facetItemClick=IV.facetItemClick;PV.facetSliderDrag=IV.facetSliderDrag}};IV.isOn=function(){return IV._isOn};IV.getIV=function(){var t=$(".pv-facet[iv=true]"),o=[],i=[],n,r,u,f,e;for(t.length==0&&(t=$(".pv-facet").eq(0)),n=0;n<t.length;n++)if(r=PivotCollection.getCategoryByName(t.eq(n).children().eq(0).html()),o.push(r),i.push([]),r.type!=PivotViewer.Models.FacetType.DateTime)if(r.type==PivotViewer.Models.FacetType.String)for(u=t.next().find(".pv-facet-iv:checked"),u.length==0&&(u=t.next().find(".pv-facet-iv")),f=0;f<u.length;f++)e=_nameMapping[u.eq(f).attr("itemvalue")],i[n][e]=!0,i[n].push(e);else i[n]=$("#pv-filterpanel-numericslider-"+cleanName(r.name));return{categories:o,values:i}};
